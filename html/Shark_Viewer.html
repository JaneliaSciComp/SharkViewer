<!doctype html>
<html>
	<head>
		<title>Shark Viewer</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		
			
		<script src="js/threejs/three.min.js"></script>
		<script src="js/threejs/TrackballControls.js"></script>
		<script src="./js/shark_viewer.js"></script>
		<!-- optional only if show_stats = true -->
		<script src="js/threejs/Stats.js"></script>

<script id='metadata_swc' type='text/plain'>
[{"label":"undefined","type":0},{"label":"soma","type":1},{"label":"axon","type":2},{"label":"dendrite","type":3},{"label":"apical dendrite","type":4},{"label":"fork point","type":5},{"label":"end point","type":6},{"label":"custom","type":7}]
</script>
</head>
<body>
	<label for='swc_input'>Upload a swc file to view it in the SharkViewer:</label><input type='file' name='swc_input' id='swc_input' />
	<!-- three.js container -->
    	<div id="container" style='position:relative'></div>
	<!-- info on screen display -->


	<script type='text/javascript'>
	function readSwcFile(e) {
		var f = e.target.files[0]; 
		console.log(f);
		if (f) {
			var r = new FileReader();
			r.onload = function(e2) { 
				var swc_txt = e2.target.result;
				var swc = swc_parser(swc_txt);
				if ( Object.keys(swc).length > 0 ) {
					//remove previous neuron
					document.getElementById('container').innerHTML = "";

					var s = new SharkViewer({
						swc: swc, 
						dom_element: 'container', 
						center_node: -1, 
						show_stats: true, 
						metadata: mdata
					});
					s.init();
					s.animate();
				}
				else {
					alert("Please upload a valid swc file.");
				}
			}
			r.readAsText(f);
		} else { 
		      alert("Failed to load file");
		}
	}
	window.onload = function() {
		document.getElementById('swc_input').addEventListener('change', readSwcFile, false);
		var swc = swc_parser(document.getElementById("swc").text);
		var s = new SharkViewer({
			swc: swc,
			mode: 'particle',
			dom_element: 'container', 
			center_node: -1, 
			show_stats: false});
		s.init();
		s.animate();
	}
	</script>
</body>
</html>

